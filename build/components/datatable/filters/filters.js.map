{"version":3,"file":"filters.js","sources":["../../../../src/components/datatable/filters/filters.tsx"],"sourcesContent":["import React, { ChangeEvent } from \"react\"\r\nimport { T } from \"../../../conf/i18n\"\r\nimport { Select, MenuItem, makeStyles } from \"@material-ui/core\"\r\nimport { compareKeys } from \"../helpers/helpers\"\r\nimport { ParticeepDatePicker } from \"../../inputs\"\r\nimport moment, { MomentInput } from \"moment\"\r\nimport { FilterOption, FiltersArrayCustomProps, FiltersBooleanProps, FiltersDateProps } from \"../models/models\"\r\nimport { IObject } from \"../../types\"\r\nimport { ClassNameMap } from \"@material-ui/core/styles/withStyles\"\r\nimport { Theme } from \"@material-ui/core/styles/createMuiTheme\"\r\n\r\nconst filterHeight: number = 33\r\n\r\nconst useStyles: (props?: any) => ClassNameMap<any> = makeStyles((theme: Theme) => ({\r\n  root : {\r\n    height : filterHeight\r\n  },\r\n  dateAfter : {\r\n    height       : filterHeight,\r\n    marginBottom : theme.spacing(0.3)\r\n  },\r\n  dateBefore : {\r\n    height : filterHeight\r\n  }\r\n}))\r\n\r\nexport const defaultDateFilter: IObject = {\r\n  after  : null,\r\n  before : null\r\n}\r\n\r\nconst valueToFilter = (value: string): boolean | string => {\r\n  switch (value) {\r\n  case  \"true\":\r\n    return true\r\n  case \"false\":\r\n    return false\r\n  default:\r\n    return \"all\"\r\n  }\r\n}\r\n\r\nconst filterToValue = (filter: boolean): string => {\r\n  switch (filter) {\r\n  case true:\r\n    return \"true\"\r\n  case false:\r\n    return \"false\"\r\n  default:\r\n    return \"all\"\r\n  }\r\n}\r\n\r\nexport const FiltersBoolean = ({ name, onFilter, filter }: FiltersBooleanProps): JSX.Element => {\r\n  const classes: ClassNameMap<any> = useStyles()\r\n  const onChange = (e: ChangeEvent<{ value: any }>) => onFilter(name, valueToFilter(e.target.value))\r\n  return (\r\n    <Select\r\n      className={classes.root}\r\n      style={{ width: \"100%\" }}\r\n      value={filterToValue(filter)}\r\n      onChange={onChange}\r\n    >\r\n      <MenuItem value=\"all\" />\r\n      <MenuItem value=\"false\">{T.global.no}</MenuItem>\r\n      <MenuItem value=\"true\">{T.global.yes}</MenuItem>\r\n    </Select>\r\n  )\r\n}\r\n\r\nexport const FiltersArrayCustom = ({ name, options, onFilter, filter, withAllOption = true }: FiltersArrayCustomProps): JSX.Element => {\r\n  const classes: ClassNameMap<any> = useStyles()\r\n  const onChange = (e: ChangeEvent<{ value: any }>) => onFilter(name, e.target.value ? e.target.value : null)\r\n  return (\r\n    <Select\r\n      className={classes.root}\r\n      style={{ width: \"100%\" }}\r\n      value={filter ? filter : \"\"}\r\n      onChange={onChange}\r\n    >\r\n      {withAllOption &&\r\n        <MenuItem value=\"all\" />\r\n      }\r\n      {options.map((o: FilterOption, index: number) => <MenuItem key={`${name}-${index}`} value={o.value}>{o.label}</MenuItem>)}\r\n    </Select>\r\n  )\r\n}\r\n\r\nexport const FiltersDate = ({ name, onFilter, after, before }: FiltersDateProps): JSX.Element => {\r\n  const classes: ClassNameMap<any> = useStyles()\r\n  const onChange = (type: string) => (date: MomentInput) => onFilter(name, type, moment(date).toISOString())\r\n  return (\r\n    <div>\r\n      <ParticeepDatePicker\r\n        className={classes.dateAfter}\r\n        label={T.datatable.filter.after}\r\n        value={after ? after : null}\r\n        {...before && { maxDate: new Date(before) }}\r\n        onChange={onChange(\"after\")}\r\n        clearable={true}\r\n      />\r\n      <ParticeepDatePicker\r\n        className={classes.dateBefore}\r\n        label={T.datatable.filter.before}\r\n        value={before ? before : null}\r\n        {...after && { minDate: new Date(after) }}\r\n        onChange={onChange(\"before\")}\r\n        clearable={true}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const buildFilterValues: any = (filters: IObject): IObject => {\r\n  const clone: IObject = Object.assign({}, filters)\r\n  Object.keys(filters).forEach((key: string) => {\r\n    if (filters[key] === null || filters[key] === undefined || (filters[key] && filters[key].length === 0)) {\r\n      delete clone[key]\r\n    } else {\r\n      if (compareKeys(filters[key], defaultDateFilter)) {\r\n        clone[`${key.replace(\"_at\", \"_after\")}`] =  filters[key].after ? filters[key].after : \"\"\r\n        clone[`${key.replace(\"_at\", \"_before\")}`] = filters[key].before ? filters[key].before : \"\"\r\n        delete clone[key]\r\n      }\r\n      if (filters[key] === \"all\") {\r\n        clone[key] = \"\"\r\n      }\r\n    }\r\n  })\r\n  return clone\r\n}\r\n"],"names":["React"],"mappings":"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"}