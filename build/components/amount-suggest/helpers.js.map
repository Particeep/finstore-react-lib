{"version":3,"file":"helpers.js","sources":["../../../src/components/amount-suggest/helpers.ts"],"sourcesContent":["import { BigNumber } from \"bignumber.js\"\r\n//TODO: add unit tests for functions below\r\n\r\nexport const amountSuggestMaxWidth : number = 430\r\n\r\nexport interface ISuggestions {\r\n  suggestedTicks: Array<number>\r\n  pickedTick: number\r\n}\r\n\r\nconst buildInitialSuggestionPositions = (nbSuggestions: number): Array<number> => {\r\n  return Array(nbSuggestions).fill(0)\r\n    .map((a: number, index:number) => index - Math.floor(nbSuggestions / 2) )\r\n}\r\n\r\nexport const computeInitialSuggestedTicks = (amount: number, sharePrice: number, nbSuggestions: number): Array<number> => {\r\n  const numberTicks: number = Math.ceil(new BigNumber(amount).dividedBy(sharePrice).toNumber())\r\n  const ticksPositions: Array<number> = buildInitialSuggestionPositions(nbSuggestions)\r\n  return ticksPositions.map((p: number) => p + numberTicks)\r\n}\r\n\r\nconst canPick = (amount: number, tickToPick: number, sharePrice: number): boolean => {\r\n  return amount && new BigNumber(tickToPick).multipliedBy(sharePrice).isEqualTo(amount)\r\n}\r\n\r\nconst maybePickOneTick = (amount: number, tickToPick: number, sharePrice: number): number => {\r\n  if (canPick(amount, tickToPick, sharePrice)) {\r\n    return tickToPick\r\n  }\r\n  return undefined\r\n}\r\n\r\nconst computeSuggestionsTendTowardsMin = (amount: number, suggestedTicks: Array<number>, sharePrice: number, min: number): ISuggestions => {\r\n  const newSuggestedTicks: Array<number> = suggestedTicks.map((tick: number) => tick + 1)\r\n  if ((newSuggestedTicks[0] * sharePrice) < min) {\r\n    return computeSuggestionsTendTowardsMin(amount, newSuggestedTicks, sharePrice, min)\r\n  } else {\r\n    return {\r\n      suggestedTicks : newSuggestedTicks,\r\n      pickedTick     : maybePickOneTick(amount, newSuggestedTicks[0], sharePrice)\r\n    }\r\n  }\r\n}\r\n\r\nconst computeSuggestionsTendTowardsMax = (amount: number, suggestedTicks: Array<number>, sharePrice: number, max: number): ISuggestions => {\r\n  const newSuggestedTicks: Array<number> = suggestedTicks.map((tick: number) => tick - 1)\r\n  if ((newSuggestedTicks[newSuggestedTicks.length - 1] * sharePrice) > max) {\r\n    return computeSuggestionsTendTowardsMax(amount, newSuggestedTicks, sharePrice, max)\r\n  } else {\r\n    return {\r\n      suggestedTicks : newSuggestedTicks,\r\n      pickedTick     : maybePickOneTick(amount, newSuggestedTicks[newSuggestedTicks.length - 1], sharePrice)\r\n    }\r\n  }\r\n}\r\n\r\nexport const computeNewTicks = (amount: number, sharePrice: number, min: number, max: number, nbSuggestions: number): ISuggestions => {\r\n  const sanitizedAmount: number = amount || min || 0\r\n  const initialSuggestedTicks: Array<number> = computeInitialSuggestedTicks(sanitizedAmount, sharePrice, nbSuggestions)\r\n  if (initialSuggestedTicks[0] * sharePrice < min) {\r\n    return computeSuggestionsTendTowardsMin(sanitizedAmount, initialSuggestedTicks, sharePrice, min)\r\n  } else if (initialSuggestedTicks[initialSuggestedTicks.length - 1] * sharePrice > max) {\r\n    return  computeSuggestionsTendTowardsMax(sanitizedAmount, initialSuggestedTicks, sharePrice, max)\r\n  } else {\r\n    return {\r\n      suggestedTicks : initialSuggestedTicks,\r\n      pickedTick     : maybePickOneTick(amount, initialSuggestedTicks[1], sharePrice)\r\n    }\r\n  }\r\n}\r\n\r\nconst isFactorOf = (factor: number, number: number): boolean => {\r\n  return new BigNumber(factor).dividedBy(number).isInteger()\r\n}\r\n\r\nexport const computeShareStyleClass = (amount: number, sharePrice: number): string => {\r\n  if (!amount) {\r\n    return \"\"\r\n  }\r\n  if (isFactorOf(amount, sharePrice)) {\r\n    return \"success\"\r\n  } else {\r\n    return \"error\"\r\n  }\r\n}\r\n\r\nexport const computeMinStyleClass = (amount: number, min: number): string => {\r\n  if (!amount) {\r\n    return \"\"\r\n  }\r\n  if (amount >= min) {\r\n    return \"success\"\r\n  } else {\r\n    return \"error\"\r\n  }\r\n}\r\n\r\nexport const computeMaxStyleClass = (amount: number, max: number): string => {\r\n  if (!amount) {\r\n    return \"\"\r\n  }\r\n  if (amount <= max) {\r\n    return \"success\"\r\n  } else {\r\n    return \"error\"\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}