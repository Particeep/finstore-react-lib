{"version":3,"file":"AmountSuggest.js","sources":["../../../src/components/amount-suggest/AmountSuggest.tsx"],"sourcesContent":["import React, { ChangeEvent, useEffect, useState } from \"react\"\r\nimport { BigNumber } from \"bignumber.js\"\r\nimport { ReactState } from \"../types\"\r\nimport AmountSuggestDisplay from \"./AmountSuggestDisplay\"\r\nimport { amountSuggestMaxWidth, computeNewTicks, ISuggestions } from \"./helpers\"\r\nimport { IWindowSize, useWindowSize } from \"../../utils\"\r\n\r\nexport interface AmountSuggestProps {\r\n  sharePrice: number\r\n  currency: string\r\n  fundraiseType: string\r\n  max: number\r\n  min: number\r\n  onSelect: (amount: number) => void\r\n}\r\n\r\nexport const AmountSuggest = (props: AmountSuggestProps): JSX.Element => {\r\n  const { min, max, onSelect, sharePrice, currency, fundraiseType }: AmountSuggestProps = props\r\n  const windowSize: IWindowSize = useWindowSize()\r\n  const computeSuggestionNb = (): number => windowSize.width > amountSuggestMaxWidth ? 3 : 2\r\n\r\n  const [ suggestedTicks, setSuggestedTicks ]: ReactState<Array<number>> = useState()\r\n  const [ pickedTick, setPickedTick ]: ReactState<number> = useState()\r\n  const [ typedAmount, setTypedAmount ]: ReactState<number> = useState()\r\n  const [ suggestionNumber, setSuggestionNumber ]: ReactState<number> = useState(computeSuggestionNb())\r\n\r\n  const sanitizedPickedTick: number = pickedTick || suggestedTicks && suggestedTicks[0]\r\n\r\n  const onTypedAmountChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    const amount: number = +event.target.value\r\n    setTypedAmount(amount)\r\n    setSuggestion(amount, suggestionNumber)\r\n  }\r\n\r\n  useEffect(() => {\r\n    setSuggestion(0, suggestionNumber)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const suggestionsNb: number = computeSuggestionNb()\r\n    setSuggestionNumber(suggestionsNb)\r\n    setSuggestion(0, suggestionsNb)\r\n    setTypedAmount(0)\r\n    setPickedTick(0)\r\n  }, [ windowSize ])\r\n\r\n  const setSuggestion = (amount: number, suggestionNumber: number) => {\r\n    const suggestions: ISuggestions = computeNewTicks(amount, sharePrice, min, max, suggestionNumber)\r\n    setSuggestedTicks(suggestions.suggestedTicks)\r\n    if (suggestions && amount) {\r\n      pick(suggestions.pickedTick)\r\n    }\r\n  }\r\n\r\n  const pick = (tick: number) => {\r\n    const pickedTick: number = Math.round(tick)\r\n    const amountPicked: number = pickedTick * props.sharePrice\r\n    setPickedTick(pickedTick)\r\n    if (amountPicked) {\r\n      onSelect(amountPicked)\r\n      setTypedAmount(amountPicked)\r\n    }\r\n  }\r\n\r\n  const prev = () => {\r\n    if (pickedTick === suggestedTicks[0]) {\r\n      setSuggestedTicks(suggestedTicks.map((tick: number) => tick - 1))\r\n    }\r\n    pick(Math.max(new BigNumber(min).dividedBy(sharePrice).toNumber(), sanitizedPickedTick - 1))\r\n  }\r\n\r\n  const next = () => {\r\n    if (pickedTick === suggestedTicks[suggestedTicks.length - 1]) {\r\n      setSuggestedTicks(suggestedTicks.map((tick: number) => tick + 1))\r\n    }\r\n    pick(Math.min(new BigNumber(max).dividedBy(sharePrice).toNumber(), sanitizedPickedTick + 1))\r\n  }\r\n\r\n  const canPrev = () => {\r\n    return min <= (sanitizedPickedTick - 1) * sharePrice\r\n  }\r\n\r\n  const canNext = () => {\r\n    return !max || max >= (sanitizedPickedTick + 1) * props.sharePrice\r\n  }\r\n\r\n  return (\r\n    <AmountSuggestDisplay\r\n      onAmountChange={onTypedAmountChange}\r\n      typedAmount={typedAmount}\r\n      prev={prev}\r\n      canPrev={canPrev()}\r\n      next={next}\r\n      canNext={canNext()}\r\n      sharePrice={sharePrice}\r\n      suggestedTicks={suggestedTicks}\r\n      pick={pick}\r\n      pickedTick={pickedTick}\r\n      currency={currency}\r\n      fundraiseType={fundraiseType}\r\n      min={min}\r\n      max={max}\r\n    />\r\n  )\r\n}\r\n"],"names":["React"],"mappings":"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"}